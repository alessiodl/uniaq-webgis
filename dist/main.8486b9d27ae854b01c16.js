!function(t){function e(e){for(var n,i,s=e[0],l=e[1],c=e[2],u=0,p=[];u<s.length;u++)i=s[u],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&p.push(o[i][0]),o[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);for(d&&d(e);p.length;)p.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],n=!0,s=1;s<a.length;s++){var l=a[s];0!==o[l]&&(n=!1)}n&&(r.splice(e--,1),t=i(i.s=a[0]))}return t}var n={},o={0:0},r=[];function i(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=n,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(a,n,function(e){return t[e]}.bind(null,n));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var d=l;r.push([174,1]),a()}({170:function(t,e,a){var n={"./af":11,"./af.js":11,"./ar":12,"./ar-dz":13,"./ar-dz.js":13,"./ar-kw":14,"./ar-kw.js":14,"./ar-ly":15,"./ar-ly.js":15,"./ar-ma":16,"./ar-ma.js":16,"./ar-sa":17,"./ar-sa.js":17,"./ar-tn":18,"./ar-tn.js":18,"./ar.js":12,"./az":19,"./az.js":19,"./be":20,"./be.js":20,"./bg":21,"./bg.js":21,"./bm":22,"./bm.js":22,"./bn":23,"./bn.js":23,"./bo":24,"./bo.js":24,"./br":25,"./br.js":25,"./bs":26,"./bs.js":26,"./ca":27,"./ca.js":27,"./cs":28,"./cs.js":28,"./cv":29,"./cv.js":29,"./cy":30,"./cy.js":30,"./da":31,"./da.js":31,"./de":32,"./de-at":33,"./de-at.js":33,"./de-ch":34,"./de-ch.js":34,"./de.js":32,"./dv":35,"./dv.js":35,"./el":36,"./el.js":36,"./en-SG":37,"./en-SG.js":37,"./en-au":38,"./en-au.js":38,"./en-ca":39,"./en-ca.js":39,"./en-gb":40,"./en-gb.js":40,"./en-ie":41,"./en-ie.js":41,"./en-il":42,"./en-il.js":42,"./en-nz":43,"./en-nz.js":43,"./eo":44,"./eo.js":44,"./es":45,"./es-do":46,"./es-do.js":46,"./es-us":47,"./es-us.js":47,"./es.js":45,"./et":48,"./et.js":48,"./eu":49,"./eu.js":49,"./fa":50,"./fa.js":50,"./fi":51,"./fi.js":51,"./fo":52,"./fo.js":52,"./fr":53,"./fr-ca":54,"./fr-ca.js":54,"./fr-ch":55,"./fr-ch.js":55,"./fr.js":53,"./fy":56,"./fy.js":56,"./ga":57,"./ga.js":57,"./gd":58,"./gd.js":58,"./gl":59,"./gl.js":59,"./gom-latn":60,"./gom-latn.js":60,"./gu":61,"./gu.js":61,"./he":62,"./he.js":62,"./hi":63,"./hi.js":63,"./hr":64,"./hr.js":64,"./hu":65,"./hu.js":65,"./hy-am":66,"./hy-am.js":66,"./id":67,"./id.js":67,"./is":68,"./is.js":68,"./it":69,"./it-ch":70,"./it-ch.js":70,"./it.js":69,"./ja":71,"./ja.js":71,"./jv":72,"./jv.js":72,"./ka":73,"./ka.js":73,"./kk":74,"./kk.js":74,"./km":75,"./km.js":75,"./kn":76,"./kn.js":76,"./ko":77,"./ko.js":77,"./ku":78,"./ku.js":78,"./ky":79,"./ky.js":79,"./lb":80,"./lb.js":80,"./lo":81,"./lo.js":81,"./lt":82,"./lt.js":82,"./lv":83,"./lv.js":83,"./me":84,"./me.js":84,"./mi":85,"./mi.js":85,"./mk":86,"./mk.js":86,"./ml":87,"./ml.js":87,"./mn":88,"./mn.js":88,"./mr":89,"./mr.js":89,"./ms":90,"./ms-my":91,"./ms-my.js":91,"./ms.js":90,"./mt":92,"./mt.js":92,"./my":93,"./my.js":93,"./nb":94,"./nb.js":94,"./ne":95,"./ne.js":95,"./nl":96,"./nl-be":97,"./nl-be.js":97,"./nl.js":96,"./nn":98,"./nn.js":98,"./pa-in":99,"./pa-in.js":99,"./pl":100,"./pl.js":100,"./pt":101,"./pt-br":102,"./pt-br.js":102,"./pt.js":101,"./ro":103,"./ro.js":103,"./ru":104,"./ru.js":104,"./sd":105,"./sd.js":105,"./se":106,"./se.js":106,"./si":107,"./si.js":107,"./sk":108,"./sk.js":108,"./sl":109,"./sl.js":109,"./sq":110,"./sq.js":110,"./sr":111,"./sr-cyrl":112,"./sr-cyrl.js":112,"./sr.js":111,"./ss":113,"./ss.js":113,"./sv":114,"./sv.js":114,"./sw":115,"./sw.js":115,"./ta":116,"./ta.js":116,"./te":117,"./te.js":117,"./tet":118,"./tet.js":118,"./tg":119,"./tg.js":119,"./th":120,"./th.js":120,"./tl-ph":121,"./tl-ph.js":121,"./tlh":122,"./tlh.js":122,"./tr":123,"./tr.js":123,"./tzl":124,"./tzl.js":124,"./tzm":125,"./tzm-latn":126,"./tzm-latn.js":126,"./tzm.js":125,"./ug-cn":127,"./ug-cn.js":127,"./uk":128,"./uk.js":128,"./ur":129,"./ur.js":129,"./uz":130,"./uz-latn":131,"./uz-latn.js":131,"./uz.js":130,"./vi":132,"./vi.js":132,"./x-pseudo":133,"./x-pseudo.js":133,"./yo":134,"./yo.js":134,"./zh-cn":135,"./zh-cn.js":135,"./zh-hk":136,"./zh-hk.js":136,"./zh-tw":137,"./zh-tw.js":137};function o(t){var e=r(t);return a(e)}function r(t){if(!a.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}o.keys=function(){return Object.keys(n)},o.resolve=r,t.exports=o,o.id=170},171:function(t,e,a){var n=a(172);"string"==typeof n&&(n=[[t.i,n,""]]);var o={insert:"head",singleton:!1};a(4)(n,o);n.locals&&(t.exports=n.locals)},172:function(t,e,a){e=t.exports=a(3)(!1);var n=a(8)(a(173));e.push([t.i,"body {\r\n    padding: 0;\r\n    margin: 0;\r\n}\r\nhtml, body, #map-container {\r\n    height: 100%;\r\n    width: 100%;\r\n}\r\n\r\n/* Loader */\r\n.no-js #loader { display: none;  }\r\n.js #loader { display: block; position: absolute; left: 100px; top: 0; }\r\n.se-pre-con {\r\n  position: fixed;\r\n  left: 0px;\r\n  top: 0px;\r\n  width: 100%;\r\n  height: 100%;\r\n  z-index: 9999;\r\n  background: url("+n+') center no-repeat #fff;\r\n}\r\n\r\n/* Leaflet overrides */\r\n/*********************/\r\n\r\n.leaflet-popup-content-wrapper {\r\n    border-radius: 2px !important;\r\n    font-family: "Ubuntu", Tahoma, "Helvetica Neue", Helvetica, Arial, sans-serif !important;\r\n    font-size:14px !important;\r\n}\r\n.leaflet-popup-content-wrapper a{\r\n  color:#dd4814;\r\n  cursor:pointer;\r\n}\r\n\r\n.leaflet-popup-content-wrapper a:hover{\r\n  color:#97310e;\r\n}\r\n\r\n.leaflet-bar a:last-child {\r\n    border-bottom-left-radius: 2px !important;\r\n    border-bottom-right-radius: 2px !important;\r\n}\r\n\r\n.leaflet-bar a:first-child {\r\n    border-top-left-radius: 2px !important;\r\n    border-top-right-radius: 2px !important;\r\n}\r\n\r\n.leaflet-control-layers {\r\n  border-radius: 2px !important;\r\n}\r\n\r\n/* Stili customizzati Sidebar */\r\n/* ************************** */\r\n@media (min-width: 1200px) {\r\n    .leaflet-sidebar {\r\n        width: 620px;\r\n        max-width: 620px;\r\n    }\r\n}\r\n\r\n.leaflet-sidebar-header {\r\n\tbackground-color: #C0392B !important;\r\n}\r\n\r\n.leaflet-sidebar-tabs {\r\n    padding: 0 0 0 2px !important;\r\n}\r\n\r\n.leaflet-sidebar-tabs > ul > li {\r\n    font-size:20px;\r\n}\r\n\r\n.leaflet-sidebar-tabs > ul > li.active {\r\n    background-color: #4A235A !important;\r\n    margin: 0 0 0 -2px;\r\n}\r\n\r\n.leaflet-sidebar-tabs > ul > li:hover {\r\n    margin: 0 0 0 -2px;\r\n    font-size: 22px;\r\n    color: #C0392B;\r\n}\r\n\r\n/* Stili customizzati jsPanel */\r\n/* ************************** */\r\n.jsPanel { z-index: 10001 !important; }\r\n.jsPanel .jsPanel-hdr { line-height: 2.1; }\r\n.jsPanel .jsPanel-ftr.active { padding: 6px 8px; }\r\n.jsPanel-depth-3 { box-shadow: none; border-radius: 2px; }\r\n.jsPanel-headerlogo { font-size: 20px; }',""])},173:function(t,e,a){t.exports=a.p+"1c7682c778ab7be68d1b96055867a58b.gif"},174:function(t,e,a){"use strict";a.r(e);var n=a(1),o=a.n(n),r=(a(138),a(7),a(142),a(143),a(145),a(146),a(148),a(149),a(154),a(155),a(157),a(160),a(162),a(163),a(6)),i=a.n(r),s=a(2),l=(a(164),a(165),a(167),{serverURL:"https://alessiodl.pythonanywhere.com",username:"",development:!0,version:"Prototype"});let c=function(){$.getJSON({url:l.serverURL+"/api/comuni",data:{token:l.token,istatComune:"069101,068035,068026,066060"},success:function(t){var e="";$.each(t.features,(function(t,a){e+="<option data-icon='fas fa-city' value='"+a.properties.cod_istat+"'>"+a.properties.nome+"</option>"})),$("#comuni-filter").empty().append(e),$("#comuni-filter").selectpicker("val","069101"),$("#comuni-filter").prop("disabled",!1),$("#comuni-filter").selectpicker("refresh"),P("069101"),setTimeout((function(){var t;w(),k("069101"),t="069101",$.ajax({url:l.serverURL+"/api/raster/list",data:{istatComune:t},success:function(t){var e="";$.each(t.raster_data,(function(t,a){e+="<option data-icon='far fa-map' value='"+a.filename+"'>"+a.alias+"</option>"})),$("#raster-filter").empty().append(e),$("#raster-filter").selectpicker("refresh")}})}),500)}})};a(10),a(168);a(169);let d;let u;let p=function(){$.ajax({url:l.serverURL+"/api/dati/microbiologici",data:{token:l.token,istatComune:$("#comuni-filter").val(),tipoDati:$("#dati-filter").val()},success:function(t){var e,a,n;"biodiversita_funzionale"==$("#dati-filter").val()?(e=t,a=[],n=$("#periodo-filter").val(),$.each(e,(function(t,e){e.PERIODO==n&&a.push([e["ID CAMPIONE"],e.COMUNE,e.PERIODO,e.AWCD,e.SW,e.VC])})),$("#data-grid").DataTable({destroy:!0,data:a,scrollY:250,scrollX:!1,scrollCollapse:!0,searching:!1,paging:!1,info:!1,language:{url:"https://cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Italian.json"},columns:[{title:"Punto"},{title:"Comune",visible:!1},{title:"Data"},{title:"AWCD"},{title:"SW"},{title:"VC"}],order:[[2,"asc"]]}),function(t){var e=document.getElementById("data-chart").getContext("2d");d&&d.destroy();var a=$("#periodo-filter").val(),n=[];$.each(t,(function(t,e){e.PERIODO==a&&n.push(e.AWCD)}));var o=[];$.each(t,(function(t,e){e.PERIODO==a&&o.push(e.SW)}));var r=[];$.each(t,(function(t,e){e.PERIODO==a&&r.push(e.VC)})),d=new Chart(e,{type:"bar",data:{labels:["Punto 1","Punto 2","Punto 3","Punto 4","Punto 5","Punto 6","Punto 7","Punto 8"],datasets:[{label:"AWCD",backgroundColor:"#FFC300",borderColor:"#FFC300",data:n},{label:"SW",backgroundColor:"#FF5733",borderColor:"#FF5733",data:o},{label:"VC",backgroundColor:"#C70039",borderColor:"#C70039",data:r}]},options:{responsive:!0}})}(t)):"biodiversita_genetica"==$("#dati-filter").val()&&(function(t){var e=[],a=$("#periodo-filter").val();$.each(t,(function(t,n){n.PERIODO==a&&e.push([n["ID CAMPIONE"],n.COMUNE,n.PERIODO,n["1-D"],n.Ed,n.Fo])})),$("#data-grid").DataTable({destroy:!0,data:e,scrollY:250,scrollX:!1,scrollCollapse:!0,searching:!1,paging:!1,info:!1,language:{url:"https://cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Italian.json"},columns:[{title:"Punto"},{title:"Comune",visible:!1},{title:"Data"},{title:"1-D"},{title:"Ed"},{title:"Fo"}],order:[[2,"asc"]]})}(t),function(t){var e=document.getElementById("data-chart").getContext("2d");d&&d.destroy();var a=$("#periodo-filter").val(),n=[];$.each(t,(function(t,e){e.PERIODO==a&&n.push(e["1-D"])}));var o=[];$.each(t,(function(t,e){e.PERIODO==a&&o.push(e.Ed)}));var r=[];$.each(t,(function(t,e){e.PERIODO==a&&r.push(e.Fo)})),d=new Chart(e,{type:"bar",data:{labels:["Punto 1","Punto 2","Punto 3","Punto 4","Punto 5","Punto 6","Punto 7","Punto 8"],datasets:[{label:"1-D",backgroundColor:"#FFC300",borderColor:"#FFC300",data:n},{label:"Ed",backgroundColor:"#FF5733",borderColor:"#FF5733",data:o},{label:"Fo",backgroundColor:"#C70039",borderColor:"#C70039",data:r}]},options:{responsive:!0}})}(t))}})},f=function(){$.ajax({url:l.serverURL+"/api/dati/vinificazione",data:{token:l.token,istatComune:$("#comuni-filter").val(),tipoDati:$("#dati-filter").val()},success:function(t){var e,a,n;"maturazione_tecnologica"==$("#dati-filter").val()?(e=t,a=[],n=$("#periodo-filter").val(),$.each(e,(function(t,e){e.PERIODO==n&&a.push([e.ID_CAMPIONE,e.COMUNE,e.PERIODO,e.ACIDITA_TOT,e.BABO,e.PH])})),$("#data-grid").DataTable({destroy:!0,data:a,scrollY:250,scrollX:!1,scrollCollapse:!0,searching:!1,paging:!1,info:!1,language:{url:"https://cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Italian.json"},columns:[{title:"Punto"},{title:"Comune",visible:!1},{title:"Data"},{title:"Acidità Tot."},{title:"BABO"},{title:"PH"}],order:[[2,"asc"]]}),function(t){var e=document.getElementById("data-chart").getContext("2d");d&&d.destroy();var a=$("#periodo-filter").val(),n=[];$.each(t,(function(t,e){e.PERIODO==a&&n.push(e.ACIDITA_TOT)}));var o=[];$.each(t,(function(t,e){e.PERIODO==a&&o.push(e.BABO)}));var r=[];$.each(t,(function(t,e){e.PERIODO==a&&r.push(e.PH)})),d=new Chart(e,{type:"bar",data:{labels:["Punto 1","Punto 2","Punto 3","Punto 4","Punto 5","Punto 6","Punto 7","Punto 8"],datasets:[{label:"Acidità Tot.",backgroundColor:"#4A235A",borderColor:"#4A235A",data:n},{label:"BABO",backgroundColor:"#9C27B0",borderColor:"#9C27B0",data:o},{label:"PH",backgroundColor:"#0097A7",borderColor:"#0097A7",data:r}]},options:{responsive:!0}})}(t)):"microvinificazione"==$("#dati-filter").val()&&(console.log(t),function(t){var e=[],a=$("#periodo-filter").val(),n=$("#microvin-filter").val();$.each(t,(function(t,o){o.PERIODO==a&&e.push([o.id,o.COMUNE,o.COD_ISTAT,o.ID_CAMPIONE,o.PERIODO,o[n]])})),$("#data-grid").DataTable({destroy:!0,data:e,scrollY:250,scrollX:!1,scrollCollapse:!0,searching:!1,paging:!1,info:!1,language:{url:"https://cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Italian.json"},columns:[{title:"id",visible:!1},{title:"Comune",visible:!1},{title:"Istat",visible:!1},{title:"Punto"},{title:"Data"},{title:$("#microvin-filter option:selected").text()}],order:[[0,"asc"]]})}(t),function(t){var e=document.getElementById("data-chart").getContext("2d");d&&d.destroy();var a=$("#periodo-filter").val(),n=$("#microvin-filter").val(),o=[];$.each(t,(function(t,e){e.PERIODO==a&&o.push(e[n])})),d=new Chart(e,{type:"bar",data:{labels:["Punto 1","Punto 2","Punto 3","Punto 4","Punto 5","Punto 6","Punto 7","Punto 8"],datasets:[{label:$("#microvin-filter option:selected").text(),backgroundColor:"#4A235A",borderColor:"#4A235A",data:o}]},options:{responsive:!0}})}(t))}})},m=function(){$.ajax({url:l.serverURL+"/api/dati/meteo",data:{token:l.token,idStazione:$("#stazione-filter").val()},success:function(t){!function(t){console.log(t);var e=document.getElementById("meteo-chart").getContext("2d");u&&u.destroy();var a=$("#meteo-data-filter").val(),n=[],o=[];$.each(t,(function(t,e){n.push(e.data),o.push(e[a])})),console.log(n),u=new Chart(e,{type:"line",data:{labels:n,datasets:[{label:$("#meteo-data-filter option:selected").text(),backgroundColor:"silver",borderColor:"#2471A3",fill:!1,data:o}]},options:{responsive:!0,legend:{display:!1}}})}(t)}})};const g=L.map("map-container",{attributionControl:!1}).setView([42,14],6),b=new L.Draw.Polygon(g),h=L.geoJSON(null,{style:{color:"#ff7800",weight:5,opacity:.65}}).addTo(g),v=L.canvas({padding:.5});g.createPane("labels"),g.getPane("labels").style.zIndex=650,g.getPane("labels").style.pointerEvents="none";var y=L.layerGroup([L.tileLayer.wms("http://213.215.135.196/reflector/open/service?",{maxZoom:18,layers:"rv1",format:"image/png",attribution:'<a href="http://realvista.it" target="_blank">RealVista</a> 1.0 Open WMS &copy; <a href="http://e-geos.it" target="_blank">e-GEOS SpA</a> - CC BY SA'}),L.tileLayer("http://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png",{maxZoom:18,attribution:"&copy; OpenStreetMap, &copy; CartoDB",pane:"labels"})]).addTo(g),j=L.layerGroup([L.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd"}),L.tileLayer("http://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png",{maxZoom:18,attribution:"&copy; OpenStreetMap, &copy; CartoDB",pane:"labels"})]);const C=L.geoJSON.multiStyle(null,{styles:[{color:"black",opacity:.15,weight:10,fill:!1},{color:"white",opacity:.8,weight:8,fill:!1},{color:"red",opacity:1,weight:4,fill:!1}]}).addTo(g),P=function(t){C.clearLayers(),$.getJSON({url:l.serverURL+"/api/comuni",data:{token:l.token,istatComune:t},success:function(t){C.addData(t);let e=$("#sidebar").width();g.fitBounds(C.getBounds(),{paddingBottomRight:[e,10]})}})},O=L.geoJSON(null,{pane:"punti",pointToLayer:function(t,e){return L.circleMarker(e,{renderer:v,radius:10,fillColor:"#CC0000",fillOpacity:.75,color:"#FFF",weight:2,opacity:1})},onEachFeature:function(t,e){var a=e.feature.properties;e.bindTooltip(String("P"+e.feature.properties.id),{permanent:!0,direction:"top"}).openTooltip(),e.bindPopup("Punto di campionamento: <strong>P"+a.id+"</strong><br/>Comune: "+a.comune+" ("+a.cod_istat+")</br>Altezza SLM: "+a.elevazione+" metri"),e.on({mouseover:function(t){t.target.setStyle({fillOpacity:1,radius:12,weight:3})},mouseout:function(t){e.setStyle({fillOpacity:.75,radius:10,weight:2})}})}}).addTo(g),k=function(t){O.clearLayers(),$.getJSON({url:l.serverURL+"/api/punti",data:{token:l.token,istatComune:t},success:function(t){O.addData(t),"pt"==$("#dati-filter").val()&&(setTimeout(function(){let t=[];$.each(O.toGeoJSON().features,(function(e,a){t.push([a.properties.id,a.properties.elevazione,a.properties.lat,a.properties.long,a.properties.comune,a.properties.cod_istat])})),$("#data-grid").DataTable({destroy:!0,data:t,scrollY:250,scrollX:!1,scrollCollapse:!0,searching:!1,paging:!1,info:!1,language:{url:"https://cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Italian.json"},columns:[{title:"Punto"},{title:"Elevazione (m)"},{title:"Latitudine",sortable:!1},{title:"Longitudine",sortable:!1},{title:"Comune"},{title:"Cod. Istat",sortable:!1,visible:!1}],order:[[0,"asc"]]})}(),200),setTimeout(function(){var t=[];$.each(O.toGeoJSON().features,(function(e,a){t.push(a.properties.elevazione)}));var e=document.getElementById("data-chart").getContext("2d");d&&d.destroy(),d=new Chart(e,{type:"line",data:{labels:["Punto 1","Punto 2","Punto 3","Punto 4","Punto 5","Punto 6","Punto 7","Punto 8"],datasets:[{label:"Quota SLM",backgroundColor:"#ABB2B9",borderColor:"#CC263C",data:t,fill:!1}]},options:{responsive:!0}})}(),200))}})},x=L.geoJSON(null,{pane:"punti",pointToLayer:function(t,e){return L.circleMarker(e,{renderer:v,radius:8,fillColor:"#0000CC",fillOpacity:.85,color:"#FFF",weight:1,opacity:1})},onEachFeature:function(t,e){var a=e.feature.properties;e.bindPopup("Stazione meteo: <strong>"+a.nome+"</strong><br/>Altezza SLM: "+a.altitudine),e.on({mouseover:function(t){t.target.setStyle({fillOpacity:1,radius:10,weight:2})},mouseout:function(t){e.setStyle({fillOpacity:.85,radius:8,weight:1})}})}}).addTo(g),w=function(){x.clearLayers(),$.getJSON({url:l.serverURL+"/api/stazioni/meteo",data:{token:l.token},success:function(t){x.addData(t)}})};let z;L.control.layers({Ortofoto:y,Mappa:j},{"Stazioni meteo":x,"Punti di campionamento":O,"Confini comunali":C},{position:"bottomleft"}).addTo(g),g.on("baselayerchange",(function(t){"Mappa"==t.name?O.setStyle({color:"#4A235A"}):"Ortofoto"==t.name&&O.setStyle({color:"#FFF"})}));var D=L.control.sidebar({autopan:!0,closeButton:!1,container:"sidebar",position:"right"}).addTo(g);let S=function(){D.open("home-tab"),setTimeout((function(){let t=$("#sidebar").width();g.fitBounds(C.getBounds(),{paddingBottomRight:[t,10]}),$("#"+"data"+"-grid").DataTable().columns.adjust().draw()}),750)};D.on("content",(function(t){"meteo-tab"==t.id&&m()}));let E,I=!1;o()("#add-raster-btn").click((function(){!function(){g.hasLayer(z)&&z.remove(),$("#raster-msg").html("<i class='fas fa-cog fa-spin'></i> Caricamento dati raster in corso...");var t=$("#raster-filter").val(),e=l.serverURL+"/raster_data/"+t;let a;t.includes("NDVI")?a=i.a.scale("YlGn").domain([-1,1]):t.includes("DEM")?a=i.a.scale(["#5C7E26","#94C06E","#C0AC6E","#96685E"]).domain([155.378,334.486]):t.includes("PENDENZA")?a=i.a.scale("RdGy").domain([1.599969,57.068]):t.includes("ESPOSIZIONE")&&(a=i.a.scale("RdYlGn").domain([7.20119,352.786])),fetch(e).then(t=>t.arrayBuffer()).then(t=>{parseGeoraster(t).then(t=>{(z=new GeoRasterLayer({georaster:t,opacity:.9,pixelValuesToColorFn:function(e){return e[0]===t.noDataValue?"rgba(255,255,255,0.0)":a(e[0]).hex()},resolution:256})).addTo(g),g.fitBounds(z.getBounds()),$("#raster-msg").html("<i class='fas fa-info-circle'></i> Analizzare il raster con gli strumenti a disposizione"),document.querySelector("#raster-legend").style.backgroundImage="linear-gradient(to right,"+a.colors().toString()+")",$("#raster-px-value").html('<span class="text-muted" style="font-size:16px;">Clicca sul raster ...</span>'),$("#raster-slider").val(.9),$("#raster-slider").attr("disabled",!1)})})}()})),o()("#remove-raster-btn").click((function(){o()("#raster-msg").html("<i class='fas fa-lightbulb'></i> Scegliere un raster dall'elenco e aggiungerlo alla mappa"),document.querySelector("#raster-legend").style.backgroundImage="none",o()("#raster-slider").attr("disabled",!0),o()("#raster-px-value").html('<span class="text-muted" style="font-size:16px;">Clicca sul raster ...</span>'),z.remove(),F()})),o()("#raster-slider").change((function(){z.setOpacity(o()(this).val())})),g.on("click",(function(t){let e=t.latlng.lat,a=t.latlng.lng;if(g.hasLayer(z)&&0==I){let t=geoblaze.identify(z.georaster,[a,e]);o()("#raster-px-value").html(parseFloat(t).toFixed(3))}else o()("#raster-px-value").html("...")})),o()("#draw-polygon-btn").click((function(){I=!0,b.enable()})),g.on("draw:created",(function(t){h.clearLayers();var e=t.layer;E=[];let a=e.editing.latlngs[0][0];o.a.each(a,(function(t,e){E.push([e.lng,e.lat])}));let n=E[0];E.push(n),h.addData(e.toGeoJSON()),o()("#run-analysis-btn").prop("disabled",!1),I=!1})),o()("#run-analysis-btn").click((function(){o()("#run-analysis-btn").html("<i class='fas fa-cog fa-spin'></i> Estrazione in corso...");let t={type:"Polygon",coordinates:[E]};setTimeout((function(){A(t)}),500)}));const A=function(t){try{let e=geoblaze.mean(z.georaster,t),a=geoblaze.min(z.georaster,t),n=geoblaze.max(z.georaster,t);geoblaze.mode(z.georaster,t),geoblaze.median(z.georaster,t);const r={scaleType:"ratio",numClasses:12,classType:"equal-interval"};let i=geoblaze.histogram(z.georaster,t,r),s=Object.keys(i[0]),l=Object.values(i[0]);B(s,l),o()("#raster-stats-max").html(n[0].toFixed(3)),o()("#raster-stats-min").html(a[0].toFixed(3)),o()("#raster-stats-means").html(e[0].toFixed(3))}catch(t){console.log("Si è verificato un errore!",t)}o()("#run-analysis-btn").html("<i class='fas fa-calculator'></i> Calcola valori")};let T;const B=function(t,e){var a=document.getElementById("raster-chart").getContext("2d");T&&T.destroy(),T=new Chart(a,{type:"bar",data:{labels:t,datasets:[{label:"Num. di Pixel",backgroundColor:"#229954",borderColor:"#229954",data:e}]},options:{responsive:!0,legend:!1}})};o()("#clear-polygon-btn").click((function(){F()}));const F=function(){h.clearLayers(),o()("#raster-stats-max").html("..."),o()("#raster-stats-min").html("..."),o()("#raster-stats-means").html("..."),o()("#raster-stats-mode").html("..."),o()("#raster-stats-median").html("..."),T&&T.destroy(),o()("#run-analysis-btn").prop("disabled",!0)};a(171);window.jQuery=o.a,window.$=o.a,o.a.fn.selectpicker.Constructor.BootstrapVersion="4",o()(window).on("load",(function(){setTimeout((function(){o()(".se-pre-con").fadeOut("slow"),function(){let t=s.a.modal.create({id:"panel-auth",closeOnBackdrop:!1,closeOnEscape:!1,theme:"#C0392B",border:"1px solid",iconfont:"fas",headerLogo:'<span>&nbsp;<i class="fas fa-user"></i></span>',headerTitle:"Sistema Informativo Dati Agroambientali",headerControls:"none md",position:"center-top 0 58",contentSize:"450 250",content:'<div class="col-md-12"><input id="username" type="text" class="form-control" placeholder="Nome utente"></input><br/><input id="password" type="password" class="form-control" placeholder="Password"></input></div><br/><div class="col-md-12"><p id="login-msg" class="alert alert-warning"><i class="fas fa-key"></i> Inserire le credenziali di accesso</p></div>',footerToolbar:'<button id="login-btn" class="btn btn-sm btn-secondary">Login <i class="fas fa-sign-in-alt"></i></button>',callback:function(){this.content.style.padding="20px",document.querySelector("#login-btn").addEventListener("click",(function(){$.get({url:l.serverURL+"/api/login",data:{username:$("#username").val(),password:$("#password").val()},success:function(e){console.log(e.token),l.token=e.token,l.username=$("#username").val(),c(),$("#login-msg").removeClass("alert-warning alert-danger").addClass("alert-success").html("<i class='fas fa-cog fa-spin'></i> Autenticazione riuscita! Caricamento dati..."),setTimeout((function(){document.querySelector(".leaflet-sidebar").classList.remove("collapsed"),S(),$("#info-user").html(l.username),t.close()}),3e3)},error:function(t){$("#login-msg").removeClass("alert-warning").addClass("alert-danger").html("<i class='fas fa-times'></i> Autenticazione fallita!")}})}))}})}()}),2500),g.invalidateSize(),o()("#microvin-filter").selectpicker("hide")})),o()("#comuni-filter, #dati-filter, #periodo-filter").change((function(){var t=o()("#comuni-filter").val(),e=o()("#dati-filter").val();o()("#periodo-filter").val();P(t),k(t),"biodiversita_funzionale"==e||"biodiversita_genetica"==e?(p(),o()("#microvin-filter").selectpicker("hide")):("microvinificazione"==e?(o()("#microvin-filter").selectpicker("show"),o()("#microvin-filter").change((function(){f()}))):o()("#microvin-filter").selectpicker("hide"),f())})),o()("#stazione-filter,#meteo-data-filter").change((function(){m()}))}});